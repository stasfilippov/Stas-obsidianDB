# Всплытие и погружение

Изучено: Yes
Содержание: Всплытие
Event.target
Event.currentTarget
Event.stopPropagination()
removeEventListener
Погружение

### Всплытие

- **Когда на элементе происходит событие, обработчики сначала срабатывают на нём, потом на его родителе, затем выше и так далее, вверх по цепочке предков.**
- ***Почти*** все события всплывают**. Кроме,** событие `focus` не всплывает.

**Event.target**

- **Самый глубокий элемент, который вызывает событие, называется *целевым* элементом, и он доступен через `event.target`.**
- Отличия от `this` (=`event.currentTarget`):
    - `event.target` – это «целевой» элемент, на котором произошло событие, в процессе всплытия он неизменен. Будет содержать ссылку на конкретный элемент внутри формы, на котором произошёл клик.
    - `this` – это «текущий» элемент, до которого дошло всплытие, на нём сейчас выполняется обработчик.

**Прекращение всплытия**

- Для этого нужно вызвать метод `event.stopPropagation()`.
- Любой промежуточный обработчик может решить, что событие полностью обработано, и остановить всплытие.
- Препятствует продвижению события дальше, но на текущем элементе все обработчики будут вызваны.
- Для того, чтобы полностью остановить обработку, существует метод `event.stopImmediatePropagation()`. Он не только предотвращает всплытие, но и останавливает обработку событий на текущем элементе.

### Погружение

Существует **3 фазы** прохожа событий:

1. Фаза погружения (capturing phase) – событие сначала идёт сверху вниз.
2. Фаза цели (target phase) – событие достигло целевого(исходного) элемента.
3. Фаза всплытия (bubbling stage) – событие начинает всплывать.

То есть при клике на элемент событие путешествует по цепочке родителей **сначала вниз к элементу** (погружается), затем оно **достигает целевой элемент** (фаза цели), а потом **идёт наверх** (всплытие), вызывая по пути обработчики.

- Обработчики, добавленные через `on<event>`-свойство или через HTML-атрибуты, или через `addEventListener(event, handler)` с двумя аргументами, ничего не знают о фазе погружения, а работают только на 2-ой и 3-ей фазах.
- **Чтобы поймать событие при поружении** нужно использовать третий аргумент `capture`
    
    Существуют два варианта значений опции `capture`:
    
    - Если аргумент `false` (по умолчанию), то событие будет поймано при всплытии.
    - Если аргумент `true`, то событие будет перехвачено при погружении.
- **Чтобы убрать обработчик `removeEventListener`, нужна та же фаза**
    - мы должны передать то же значение аргумента `capture` в `removeEventListener(..., true)`, когда снимаем обработчик.